(this["webpackJsonpstc-token-migration"]=this["webpackJsonpstc-token-migration"]||[]).push([[0],{297:function(t,e,n){},311:function(t,e){},319:function(t,e){},336:function(t,e){},338:function(t,e){},354:function(t,e){},355:function(t,e){},415:function(t,e){},417:function(t,e){},426:function(t,e){},428:function(t,e){},453:function(t,e){},455:function(t,e){},456:function(t,e){},461:function(t,e){},463:function(t,e){},476:function(t,e){},488:function(t,e){},491:function(t,e){},496:function(t,e){},506:function(t,e){},509:function(t,e){},567:function(t,e){},642:function(t,e){},714:function(t,e){},719:function(t,e){},727:function(t,e,n){},731:function(t,e,n){"use strict";n.r(e);var a=n(2),c=n.n(a),i=n(70),s=n.n(i),r=(n(297),n(8)),o=n.n(r),l=n(50),d=n(5),u=n(9),h=n(15),f=n(14),p=n(84),b=n(104),j=n(286),w=n.n(j),v=n(289),x=n.n(v),O=n(290),g=n.n(O),m=n(157),C=(n(727),n.p+"static/media/logoSTC.c5bc01c1.svg"),k=n(6),S={1:"mainnet",3:"ropsten"},T={1:"0xb8B7791b1A445FB1e202683a0a329504772e0E52",3:"0x2C62E18C667a8794eA7F0A139F1Ab36A4e696286"},y={1:"0x15b543e986b8c34074dfc9901136d9355a537e7e",3:"0x86DC1b4B59E5FA81Ec679B8F108F9b131C60D28A"},B={1:"mainnet",3:"0x86DC1b4B59E5FA81Ec679B8F108F9b131C60D28A"};function A(t){var e=new w.a(t);return e.eth.extend({methods:[{name:"chainId",call:"eth_chainId",outputFormatter:e.utils.hexToNumber}]}),e}var V={walletconnect:{package:g.a,options:{infuraId:"6a994151aa4a42fb89d772c6f1f00db7"}}},F=function(t){Object(h.a)(n,t);var e=Object(f.a)(n);function n(t){var a;return Object(d.a)(this,n),(a=e.call(this,t)).state={eula:!1},a.web3Modal=new x.a({network:S[3],cacheProvider:!1,providerOptions:V}),a}return Object(u.a)(n,[{key:"onConnect",value:function(){var t=Object(l.a)(o.a.mark((function t(){var e,n,a,c,i,s,r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.web3Modal.connect();case 2:return e=t.sent,t.next=5,this.subscribeProvider(e);case 5:return n=A(e),t.next=8,n.eth.getAccounts();case 8:return a=t.sent,c=a[0],t.next=12,n.eth.net.getId();case 12:return i=t.sent,t.next=15,n.eth.chainId();case 15:return s=t.sent,t.next=18,this.evalStatus(c,i,n);case 18:return r=n.utils.BN.BN,t.next=21,this.setState({web3:n,BN:r,provider:e,connected:!0,address:c,chainId:s,networkId:i});case 21:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"doApprove",value:function(){var t=Object(l.a)(o.a.mark((function t(){var e,n,a=this;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.state.web3,n=this.state.BN,this.state.old_token.methods.approve(B[3],new n(2).pow(new n(256)).sub(new n(1))).send({from:this.state.address}).on("confirmation",(function(t){a.evalStatus(a.state.address,a.state.networkID,e)}));case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"doSwap",value:function(){var t=Object(l.a)(o.a.mark((function t(){var e;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.state.web3,e=this.state.BN,this.state.old_token.methods.approve(B[3],new e(0)).send({from:this.state.address});case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"evalStatus",value:function(){var t=Object(l.a)(o.a.mark((function t(e,n,a){var c,i,s,r,l,d,u,h,f,p;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c=a.utils.BN.BN,3!==n){t.next=27;break}return i=new a.eth.Contract(m.abi,T[3]),s=new a.eth.Contract(m.abi,y[3]),t.t0=c,t.next=7,i.methods.balanceOf(e).call();case 7:return t.t1=t.sent,r=new t.t0(t.t1),t.t2=c,t.next=12,i.methods.allowance(e,B[3]).call();case 12:return t.t3=t.sent,l=new t.t2(t.t3),t.next=16,a.eth.getBalance(B[3]);case 16:return d=t.sent,t.t4=c,t.next=20,s.methods.balanceOf(B[3]).call();case 20:t.t5=t.sent,u=new t.t4(t.t5),h=r.gte(new c(1e6)),!1,f=u.gte(r.mul(new c(Math.pow(10,10))).mul(new c(Math.pow(10,6)))),p=l.gte(r),this.setState({old_token:i,new_token:s,oldBalance:r,oldAllowance:l,migratorETHBalance:d,migratorSTCV2Balance:u,eligibleForRefund:h,canMigratorRefund:false,canSwap:f,wasApproved:p});case 27:case"end":return t.stop()}}),t,this)})));return function(e,n,a){return t.apply(this,arguments)}}()},{key:"subscribeProvider",value:function(t){t.on&&(t.on("close",(function(){window.location.reload(!1)})),t.on("accountsChanged",function(){var t=Object(l.a)(o.a.mark((function t(e){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:window.location.reload(!1);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.on("chainChanged",function(){var t=Object(l.a)(o.a.mark((function t(e){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:window.location.reload(!1);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.on("networkChanged",function(){var t=Object(l.a)(o.a.mark((function t(e){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:window.location.reload(!1);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()))}},{key:"render",value:function(){var t=this;return Object(k.jsx)("div",{className:"App",children:Object(k.jsxs)("div",{class:"wrapper",children:[Object(k.jsx)("div",{}),Object(k.jsx)("div",{}),Object(k.jsx)("div",{}),Object(k.jsx)("div",{}),Object(k.jsxs)("div",{children:[Object(k.jsx)("img",{src:C,className:"App-logo",alt:"logo"}),Object(k.jsxs)("div",{className:"App-logo-text",children:[Object(k.jsx)("h2",{children:"STCV2 Token migration"}),this.state.eula?this.state.connected?3!==this.state.chainId?Object(k.jsxs)(b.a,{variant:"danger",children:[" Unsupported network id! Please switch to ",S[3],"  "]}):this.state.oldBalance.isZero()?Object(k.jsx)(b.a,{variant:"success",children:" You don't hold any STCV1 tokens "}):Object(k.jsxs)("div",{children:[Object(k.jsx)("div",{children:" Double check that you use the correct account "}),Object(k.jsxs)("div",{children:[" Connected account: ",this.state.address," "]}),Object(k.jsxs)("div",{children:[" STCV1 balance: ",this.state.oldBalance.div(new this.state.BN(Math.pow(10,2))).toString()," "]}),Object(k.jsxs)("div",{children:[" Migrators STCV1 allowance: ",this.state.oldAllowance.div(new this.state.BN(Math.pow(10,2))).toString()," "]}),Object(k.jsxs)("div",{children:[" STCV2 available swap supply: ",this.state.web3.utils.fromWei(this.state.migratorSTCV2Balance)," "]}),Object(k.jsxs)("div",{children:[" ",this.state.eligibleForRefund?"Eligible for gas refund - at the end of the migration you will receive a small ETH refund":"You're not eligible for a gas refund - you hold less than 10k STCV1"," "]}),this.state.canSwap?this.state.wasApproved?Object(k.jsx)(p.a,{variant:"success",size:"lg",onClick:this.doSwap.bind(this),children:"Swap STCV1 for STCV2?"}):Object(k.jsxs)("div",{children:[Object(k.jsx)(p.a,{variant:"success",size:"lg",onClick:this.doApprove.bind(this),children:"Approve swap?"}),Object(k.jsx)("div",{children:" In case the approval got confirmed and the app didn't acknowledge that then reload the Dapp "})]}):Object(k.jsx)(b.a,{variant:"danger",children:" Migration contract has insufficient STCV2 - contact STC support.  "})]}):Object(k.jsx)("div",{children:Object(k.jsx)(p.a,{variant:"success",size:"lg",onClick:this.onConnect.bind(this),children:"Connect wallet"})}):Object(k.jsxs)("div",{children:[Object(k.jsx)("div",{className:"App-eula",children:Object(k.jsxs)("ol",{children:[Object(k.jsx)("li",{children:" Only access this app if you're a holder of STCV1 "}),Object(k.jsx)("li",{children:" NEVER send STCV1 directly to the migration contract "}),Object(k.jsx)("li",{children:" If you disregarded 2) then contact STC support "}),Object(k.jsx)("li",{children:" You need to have ETH in your wallet in order to swap STCV1 for STCV2 "}),Object(k.jsx)("li",{children:" The swap is irreversible "}),Object(k.jsx)("li",{children:" We will swap all of your STCV1 - smaller swaps are disallowed "}),Object(k.jsx)("li",{children:" We will ask you to perform 2 ETH transactions "}),Object(k.jsx)("li",{children:" When swapping more than 10k STCV1 you will receive a full/partial gas refund for both transactions "})]})}),Object(k.jsx)(p.a,{variant:"warning",size:"lg",onClick:function(){t.setState({eula:!0})},children:"I understand what I'm doing"})]})]})]}),Object(k.jsx)("div",{}),Object(k.jsx)("div",{}),Object(k.jsx)("div",{}),Object(k.jsx)("div",{})]})})}}]),n}(a.Component),I=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,738)).then((function(e){var n=e.getCLS,a=e.getFID,c=e.getFCP,i=e.getLCP,s=e.getTTFB;n(t),a(t),c(t),i(t),s(t)}))};s.a.render(Object(k.jsx)(c.a.StrictMode,{children:Object(k.jsx)(F,{})}),document.getElementById("root")),I()}},[[731,1,2]]]);
//# sourceMappingURL=main.7842b937.chunk.js.map